<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>VELORA | Login/Signup</title>
    <link rel="stylesheet" href="/static/styles.css">
    <link href="https://fonts.googleapis.com/css2?family=Cormorant+Garamond:wght@400;500;600;700&display=swap" rel="stylesheet">
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.0.0/css/all.min.css">
</head>
<body>
    <header>
        <nav>
            <a href="index.html" class="logo">
                <i class="fas fa-couch logo-icon"></i>
                VELORA
            </a>
            <div class="nav-links">
                <a href="{{ url_for('index') }}">Home</a>
                <a href="{{ url_for('models') }}">Models</a>
                <a href="{{ url_for('design') }}">Design</a>
                <a href="{{ url_for('contact') }}">Contact</a>
                <!-- Dynamic Login/Profile Section -->
                <div id="auth-section">
                    <!-- This will be populated by JavaScript -->
                    <a href="{{ url_for('login') }}" class="login-btn">Login</a>
                </div>
                    
            </div>
        </nav>
    </header>

    <main>
        <div style="max-width: 500px; margin: 6rem auto 4rem; padding: 0 2rem; text-align: center;">
            <div class="section-title">
                <h2>Client Portal</h2>
            </div>
            <p style="color: var(--light-text); margin-bottom: 2rem;">
                Access your design dashboard or create a new account to begin your project.
            </p>
            <button id="openModal" class="view-btn" style="padding: 1rem 2rem; font-size: 1.1rem; border: none; cursor: pointer;">Login / Sign Up</button>
        </div>

        <!-- Login/Signup Modal -->
        <div class="modal-overlay" id="authModal">
            <div class="modal-content">
                <div class="modal-tabs">
                    <div class="modal-tab active" data-tab="login">Login</div>
                    <div class="modal-tab" data-tab="signup">Sign Up</div>
                </div>
                <div class="modal-panes">
                    <!-- Login Pane -->
                    <div class="modal-pane active" id="loginPane">
                        <h3 style="text-align: center; margin-bottom: 1.5rem; color: var(--title-color);">Welcome Back</h3>
                        <form style="display: grid; gap: 1.5rem;">
                            <div>
                                <label style="display: block; margin-bottom: 0.5rem; color: var(--light-text);">Email Address</label>
                                <input type="email" style="width: 100%; padding: 0.8rem; border: 1px solid #ddd; font-family: inherit;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 0.5rem; color: var(--light-text);">Password</label>
                                <input type="password" style="width: 100%; padding: 0.8rem; border: 1px solid #ddd; font-family: inherit;">
                            </div>
                            <button type="submit" class="view-btn" style="width: 100%; padding: 1rem; font-size: 1rem; border: none; background: var(--accent); color: white; cursor: pointer;">Login</button>
                        </form>
                        <p style="text-align: center; margin-top: 1.5rem; color: var(--light-text);">
                            <a href="#" style="color: var(--accent);">Forgot password?</a>
                        </p>
                    </div>
                    
                    <!-- Signup Pane -->
                    <div class="modal-pane" id="signupPane">
                        <h3 style="text-align: center; margin-bottom: 1.5rem; color: var(--title-color);">Create Account</h3>
                        <form style="display: grid; gap: 1.5rem;">
                            <div>
                                <label style="display: block; margin-bottom: 0.5rem; color: var(--light-text);">Full Name</label>
                                <input type="text" style="width: 100%; padding: 0.8rem; border: 1px solid #ddd; font-family: inherit;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 0.5rem; color: var(--light-text);">Email Address</label>
                                <input type="email" style="width: 100%; padding: 0.8rem; border: 1px solid #ddd; font-family: inherit;">
                            </div>
                            <div>
                                <label style="display: block; margin-bottom: 0.5rem; color: var(--light-text);">Password</label>
                                <input type="password" style="width: 100%; padding: 0.8rem; border: 1px solid #ddd; font-family: inherit;">
                            </div>
                            <button type="submit" class="view-btn" style="width: 100%; padding: 1rem; font-size: 1rem; border: none; background: var(--accent); color: white; cursor: pointer;">Create Account</button>
                        </form>
                        <p style="text-align: center; margin-top: 1.5rem; color: var(--light-text);">
                            Already have an account? <a href="#" class="switch-tab" style="color: var(--accent);">Login</a>
                            
                        </p>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <footer>
        <div class="footer-content">
            <div class="footer-column">
                <h3>VELORA</h3>
                <p>Creating beautiful, functional spaces that stand the test of time through thoughtful design and meticulous craftsmanship.</p>
                <div class="social-links">
                    <a href="#"><i class="fab fa-instagram"></i></a>
                    <a href="#"><i class="fab fa-pinterest"></i></a>
                    <a href="#"><i class="fab fa-houzz"></i></a>
                </div>
            </div>
            <div class="footer-column">
                <h3>Quick Links</h3>
                <a href="index.html">Home</a>
                <a href="models.html">Design Models</a>
                <a href="login.html">Login/Signup</a>
                <a href="contact.html">Contact</a>
            </div>
            <div class="footer-column">
                <h3>Contact</h3>
                <p><i class="fas fa-map-marker-alt"></i> 123 Design Avenue, INDIA</p>
                <p><i class="fas fa-phone"></i> (212) 555-1234</p>
                <p><i class="fas fa-envelope"></i> info@veloradesign.com</p>
            </div>
        </div>
        <div class="copyright">
            &copy; 2025 VELORA Interior Design. All rights reserved.
        </div>
    </footer>
        
    <script type="module">
        // app.js - Firebase Authentication for VELORA Login/Signup

// Import Firebase modules (v11.6.0 compatible)
import { initializeApp } from "https://www.gstatic.com/firebasejs/11.6.0/firebase-app.js";
import { 
    getAuth, 
    createUserWithEmailAndPassword, 
    signInWithEmailAndPassword,
} from "https://www.gstatic.com/firebasejs/11.6.0/firebase-auth.js";
import { 
    getFirestore, 
    doc, 
    setDoc 
} from "https://www.gstatic.com/firebasejs/11.6.0/firebase-firestore.js";

// Your Firebase configuration
const firebaseConfig = {
    apiKey: "AIzaSyAFFdYvQ7JqHgMTlulOlBHdrL6x8gZPPZY",
    authDomain: "contact1-a0fd2.firebaseapp.com",
    projectId: "contact1-a0fd2",
    storageBucket: "contact1-a0fd2.appspot.com",
    messagingSenderId: "484459908005",
    appId: "1:484459908005:web:bca4250e40128ea1abb64c",
    databaseURL: "https://contact1-a0fd2-default-rtdb.asia-southeast1.firebasedatabase.app"
};

// Initialize Firebase
const app = initializeApp(firebaseConfig);
const auth = getAuth(app);
const db = getFirestore(app);

// Utility function to show messages
function showMessage(message, divId) {
    const messageDiv = document.getElementById(divId);
    if (messageDiv) {
        messageDiv.style.display = "block";
        messageDiv.textContent = message;
        messageDiv.style.opacity = 1;
        setTimeout(() => { messageDiv.style.opacity = 0; }, 5000);
    }
}

// DOM Ready
document.addEventListener('DOMContentLoaded', () => {
    // Sign Up
    const signUpForm = document.querySelector('#signupPane form');
    if (signUpForm) {
        signUpForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = signUpForm.querySelector('input[type="email"]').value;
            const password = signUpForm.querySelector('input[type="password"]').value;
            const fullName = signUpForm.querySelector('input[type="text"]').value;

            try {
                const userCredential = await createUserWithEmailAndPassword(auth, email, password);
                const user = userCredential.user;

                const [firstName, ...rest] = fullName.split(' ');
                const lastName = rest.join(' ');

                await setDoc(doc(db, "users", user.uid), {
                    email,
                    firstName,
                    lastName,
                    createdAt: new Date().toISOString()
                });

                showMessage('Account created successfully!', 'signUpMessage');
                setTimeout(() => window.location.href = "{{ url_for('login') }}", 1500);
            } catch (error) {
                if (error.code === 'auth/email-already-in-use') {
                    showMessage('Email address already exists!', 'signUpMessage');
                } else if (error.code === 'auth/weak-password') {
                    showMessage('Password should be at least 6 characters', 'signUpMessage');
                } else {
                    showMessage('Error: ' + error.message, 'signUpMessage');
                }
            }
        });
    }

    // Sign In
    const signInForm = document.querySelector('#loginPane form');
    if (signInForm) {
        signInForm.addEventListener('submit', async (e) => {
            e.preventDefault();
            const email = signInForm.querySelector('input[type="email"]').value;
            const password = signInForm.querySelector('input[type="password"]').value;

            try {
                const userCredential = await signInWithEmailAndPassword(auth, email, password);
                localStorage.setItem('loggedInUserId', userCredential.user.uid);
                showMessage('Login successful!', 'signInMessage');
                setTimeout(() => window.location.href = "{{ url_for('dashboard') }}", 1500);
            } catch (error) {
                if (error.code === 'auth/invalid-credential') {
                    showMessage('Incorrect email or password', 'signInMessage');
                } else if (error.code === 'auth/user-not-found') {
                    showMessage('Account does not exist', 'signInMessage');
                } else {
                    showMessage('Login error: ' + error.message, 'signInMessage');
                }
            }
        });
    }

    // Modal and Tabs
    const modal = document.getElementById('authModal');
    const openBtn = document.getElementById('openModal');
    const tabs = document.querySelectorAll('.modal-tab');
    const panes = document.querySelectorAll('.modal-pane');
    const switchLinks = document.querySelectorAll('.switch-tab');

    if (openBtn) {
        openBtn.addEventListener('click', () => modal.classList.add('active'));
    }

    if (modal) {
        modal.addEventListener('click', (e) => {
            if (e.target === modal) modal.classList.remove('active');
        });
    }

    tabs.forEach(tab => {
        tab.addEventListener('click', () => {
            tabs.forEach(t => t.classList.remove('active'));
            panes.forEach(p => p.classList.remove('active'));
            tab.classList.add('active');
            const target = tab.getAttribute('data-tab');
            document.getElementById(`${target}Pane`).classList.add('active');
        });
    });

    switchLinks.forEach(link => {
        link.addEventListener('click', (e) => {
            e.preventDefault();
            tabs[0].classList.add('active');
            panes[0].classList.add('active');
            tabs[1].classList.remove('active');
            panes[1].classList.remove('active');
        });
    });
});

// Add message placeholders if missing
['signUpMessage', 'signInMessage'].forEach(id => {
    if (!document.getElementById(id)) {
        const msgDiv = document.createElement('div');
        msgDiv.id = id;
        msgDiv.style.cssText = `
            position: fixed;
            top: 20px;
            left: 50%;
            transform: translateX(-50%);
            background: var(--accent, #222);
            color: white;
            padding: 10px 20px;
            border-radius: 4px;
            display: none;
            transition: opacity 0.5s ease-in-out;
            z-index: 1000;
        `;
        document.body.appendChild(msgDiv);
    }
});
        
    </script>
</body>
</html>